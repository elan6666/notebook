
作为你的学习向导，我将这些资料融入之前的教学体系中。我们可以把这些来源对应到我们的学习路径上：

• **基础篇**（我们现在的阶段）：参考《Building Python Web APIs with FastAPI》第1-2章，涵盖环境、Git、Pip、路由。

• **进阶篇**：结构化项目（第5章）、数据库（第6章）。

• **高级篇**：安全认证（第7章）、测试（第8章）。

• **运维篇**：CI/CD、Docker、Nginx、AWS 部署（Dev.to 文章）。

• **性能篇**：任务队列对比（Celery vs Dramatiq）、C++加速。

--------------------------------------------------------------------------------

让我们回到正题。有了这些资料作为理论支撑，我们继续进行 **Phase 0 · 第 2 讲**。根据资料，**虚拟环境 (Virtualenv)** 是开发 FastAPI 应用不可或缺的第一步。

Phase 0 · 第 2 讲：给代码建个“无菌室”——虚拟环境 venv (2/3)

🎯 本讲目标

1. **理解核心**：为什么书上说虚拟环境能防止“全局安装冲突”？

2. **动手实操**：在项目里创建一个隔离环境。

3. **依赖管理**：学会用 `pip` 生成 `requirements.txt`（部署时的关键文件）。

--------------------------------------------------------------------------------

1. 为什么要用虚拟环境？（原理篇）

根据资料《Building Python Web APIs with FastAPI》，虚拟环境是一个**隔离的空间**。

• **场景**：你现在开发的项目 A 需要 `FastAPI 0.100`，但下个月你要维护的老项目 B 只能跑在 `FastAPI 0.60` 上。

• **后果**：如果你都装在电脑的全局 Python 里，新版本会覆盖旧版本，项目 B 当场崩溃。

• **解决**：我们给每个项目造一个独立的“房间”（venv）。项目 A 的房间里装新版，项目 B 的房间里装旧版，互不干扰。

--------------------------------------------------------------------------------

2. 创建你的第一个项目基地（操作篇）

我们要养成良好的文件管理习惯。不要把代码随便扔在桌面上。

🛠️ 手把手操作

1. **打开 PowerShell**。

2. **创建项目文件夹**： 输入以下命令（`mkdir` 是新建文件夹，`cd` 是进入文件夹）：

3. **确认位置**： 输入 `ls` (列出当前文件)，此时应该是空的。

--------------------------------------------------------------------------------

3. 创建虚拟环境 (venv)

现在我们在项目文件夹里了。书上推荐使用 `venv` 模块来创建这个隔离区。

🛠️ 手把手操作

在 PowerShell 里输入：

```
py -m venv venv
```

_(注意：命令里的第一个_ _venv_ _是模块名，第二个_ _venv_ _是我们给环境起的文件夹名字)_

**执行完后**，再次输入 `ls`，你会发现多了一个叫 `venv` 的文件夹。**绝对不要**去手动修改这个文件夹里的东西，它是 Python 的“系统盘”。

--------------------------------------------------------------------------------

4. 激活环境：最关键的一步！

创建了环境不代表你就在环境里了。资料强调，必须**激活 (Activate)** 环境才能开始安装依赖。

🛠️ 手把手操作

在 PowerShell 里输入：

```
.\venv\Scripts\Activate.ps1
```

_(技巧：输入_ _.\ve_ _然后按_ **Tab** _键，它会自动补全；继续输入_ _Sc_ _按_ **Tab**_... 这样不需要死记硬背路径)_

🛑 常见报错：如果你看到红字“禁止运行脚本”

**现象**：提示 `...cannot be loaded because running scripts is disabled on this system`. **解决**：

1. 以**管理员身份**重新打开 PowerShell。

2. 输入：`Set-ExecutionPolicy RemoteSigned`，选 `Y`。

3. 关掉窗口，回到普通 PowerShell 重新执行上面的激活命令。

✅ 成功标志

看你命令行提示符的最前面，是不是多了一个 **(venv)**？

• **激活后**：`(venv) PS C:\...\fastapi_project>`

**只要看到** **(venv)****，就说明你现在处于隔离的安全区了。**

--------------------------------------------------------------------------------

5. 安装 FastAPI 与 生成清单

根据资料，我们需要安装 `fastapi` 和 `uvicorn`。

5.1 进货（安装）

输入：

```
pip install fastapi uvicorn
```

• `fastapi`: 框架本体。

• `uvicorn`: 运行服务器的工具。

5.2 留存证据 (requirements.txt)

资料 特别强调：部署前必须更新 `requirements.txt`。这是你项目的“购物清单”。 输入：

```
pip freeze > requirements.txt
```

这会把你当前环境里所有包的版本号写入文件。以后在服务器或者 Docker 里部署时（如资料 所示），只需要运行 `pip install -r requirements.txt` 就能复刻出一模一样的环境。

--------------------------------------------------------------------------------

✅ 本讲作业（Checklist）

请在 PowerShell 里（确保已有 `(venv)` 标志）依次执行以下命令，并将输出结果截图或复制给我，确认你的环境是干净且正确的：

1. `where python` (我想确认你的 python 路径是不是指向了 `.../fastapi_project/venv/...`，而不是系统目录)。

2. `pip list` (确认 FastAPI 是否安装成功)。

3. 输入 `cat requirements.txt` (或者 `type requirements.txt`，查看你的清单文件是否生成)。

完成后，我们就可以进入 **Phase 0 · 第 3 讲**，配置 IDE 并写下你的第一行代码了！